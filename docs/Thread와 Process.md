---
slug    : /thread-process
title   : Thread와 Process의 차이
description : 
date    : 2022-12-30 22:08:54 +0900
---

## 스레드를 사용하는 이유

스레드는 동시에 여러개의 작업을 실행하기 위해 고안된 것이다. 스레드마다 Program Counter를 가지고 있으며, 별도의 스택에서 동작한다. 경량 프로세스라고 불릴 정도로 프로세스와 유사하다. 본질적인 차이는 스레드끼리는 메모리의 주소 공간을 공유한다는 것이다. 

스레드는 작업을 병렬적으로 실행할 수 있게 해준다. 싱글 코어일 경우에는 프로세스 보다 가볍게 컨텍스트 스위칭으로 동작하고, 멀티 코어일 경우에 멀티스레드를 이용하면 여러 작업이 동시에 병렬적으로 실행되게 된다. 

특히, I/O와 같이 blocking이 발생하는 작업을 하는데 유리하다. blocking이 발생하는 작업을 하나의 스레드에서 수행하고, 다른 스레드에서 필요한 작업을 하게 한다면 두 작업을 overlap 해주는 효과가 있게 된다. 

## 동시성 문제

주소 공간을 공유하여 프로세스보다 가볍게 사용할 수 있다는 장점은 동시성 문제를 발생시키는 원인이 된다. 가변적이고 공유된 메모리 공간에, 한번에 여러개의 스레드에서 접근해 변경하는 상황이 되면 동시성 문제에 노출되게 된다. 

대표적으로 문제가 일어나는 연산의 종류가 'Read and write' 연산으로 'Read'와 'Write'라는 두 연산이 하나로 움직이지 않는 것이 문제이다. 하나의 스레드에서 Read를 수행한 후에 Write를 하는 동안, 다른 스레드에서 Read를 수행하고 같은 값으로 업데이트 하는 경우가 발생할 수 있다. 

동시성 문제에서는 주로 가시성과 연산의 원자성이 문제가 된다. 이를 해소하기 위한 방법으로 스레드의 배타적 접근을 보장하는 락 계열이나 락을 사용하지 않는 Non-blocking synchronization 방법들이 있다. 

## 참고
- Operating Systems: Three Easy Pieces, Chapter 26 Concurrency, Chapter 33 Event based concurrency
